os: osx

language: generic

env:
  global:
     - secure: BOq8PDn3iGRFfvj44kxooFvi73CdGTLWparh/hZgPZOtVpaxPgmBRdowCy8CM+Sw3UHzVx4bJtpoAVlC8HKsCHzm5RzJCPlZbLel6tFSLRpQ/P0pclbi7RJVX354xUq69hckX1NMLCzD4rrh2+nhIxN/CMW/EgaZX94+99/UUrSkyN2SnJ78+zrYRZZxtC/v1m8Q00jdS0raXYzGAh9SQuSnTf2C6nH9/oXykXmElUYGI52LoqmU3OIIWQNKNWH6vhlukuih3H5nycPm2dys8l8UxIji66pqmnyZRXsVq/5xqEYbxo493GPQQPQ2k4Zec4SOXaZ34ert4KSpK36MLSKJ59dou8+JK/yUwKeJQlHzpD5Qzwt+Je/oU3RREPzhYLc7U1QnxiNlLa4YgcCfwurFGrWmFRLe+TM2Ck6FuWi0LltGDNggFgox4I73v7odU5330qsh6Jz9aSsOsS8tc9V64jZdxiI8gK/azz0k4GI9EYpzpziFZEt3HrthVKXHrssonevUtRK8a+9Df/3cV9+KedAQarzkv7t4W61c1oA1XZHh45xUpE4x5T4mBIg+Pa+lPw748BQrLJ8zc5ZJj1g9jRGUTRlngQEy0MoWiyODzSc2VqDcLSsKbADeI73xxgq+Fxl9Dih6cKedpxpoFlxPuAD1PgvwwxitPjrnnS8=

  matrix:
    - PY_VERSION=2.7
    - PY_VERSION=3.3.6
    - PY_VERSION=3.4.4
    - PY_VERSION=3.5.1

before_install:
  # note: there is cython issue when python2.7 is installed using pyenv
  - if [[ "$PY_VERSION" != "2.7" ]]; then brew update; fi
  - if [[ "$PY_VERSION" != "2.7" ]]; then brew outdated pyenv || brew upgrade pyenv; fi
  - if [[ "$PY_VERSION" != "2.7" ]]; then pyenv install $PY_VERSION; fi
  - if [[ "$PY_VERSION" != "2.7" ]]; then pyenv local $PY_VERSION; fi
  - if [[ "$PY_VERSION" != "2.7" ]]; then eval "$(pyenv init -)"; fi
  # note: but it is required to run everything in virtualenv
  - if [[ "$PY_VERSION" == "2.7" ]]; then virtualenv build-env; fi
  - if [[ "$PY_VERSION" == "2.7" ]]; then source build-env/bin/activate; fi

install:
  # simply for logging
  - python --version
  # python requirements needed to create distribution
  - python -m pip install wheel
  - python -m pip install cython
  - python -m pip install dropbox
  # get latest version of all submodules (gorilla audio)
  - git submodule update --init --recursive

script:
  - python --version
  - pip freeze
  - python setup.py build
  - python setup.py bdist_wheel
  - python dropbox_upload.py
